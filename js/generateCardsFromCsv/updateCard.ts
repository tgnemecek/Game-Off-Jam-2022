import { Card } from "./types";
import { CUSTOM_CODE_START } from "./constants";
import fs from "fs";
import { buildAutoGeneratedCode } from "./util/buildAutoGeneratedCode";

const updateCard = (card: Card, cardPath: string) => {
  const cardFile = fs.readFileSync(cardPath, "utf-8");

  const customCode = cardFile.substring(cardFile.indexOf(CUSTOM_CODE_START));

  const autoGeneratedCode = buildAutoGeneratedCode(card);

  const data = `
  ${autoGeneratedCode}

  ${customCode}
`.trim();

  return fs.writeFileSync(cardPath, data);
};

export default updateCard;
